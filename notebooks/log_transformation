import pandas as pd
from sklearn.preprocessing import PowerTransformer
import matplotlib.pyplot as plt
# 讀取資料
df = pd.read_csv('../../data/heart_2022_cleaned.csv')  # 或替換為正確路徑
# 欲轉換的數值欄位
numeric_cols = ['BMI', 'PhysicalHealth', 'MentalHealth', 'SleepTime']

# 初始化 Yeo-Johnson 轉換器
pt = PowerTransformer(method='yeo-johnson')

# 建立轉換後的資料 DataFrame
df_transformed = df.copy()
df_transformed[numeric_cols] = pt.fit_transform(df[numeric_cols])

# 畫出轉換前後的分布圖
fig, axs = plt.subplots(nrows=4, ncols=2, figsize=(12, 12))
for i, col in enumerate(numeric_cols):
    axs[i, 0].hist(df[col].dropna(), bins=30, color='skyblue')
    axs[i, 0].set_title(f'Before Transformation: {col}')
    
    axs[i, 1].hist(df_transformed[col].dropna(), bins=30, color='lightgreen')
    axs[i, 1].set_title(f'After Yeo-Johnson Transformation: {col}')

plt.tight_layout()
plt.show()

# 若你想儲存轉換後資料：
# df_transformed.to_csv('heart_2022_transformed.csv', index=False)
